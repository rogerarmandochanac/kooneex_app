<RegistroScreen>:
    name: "registro"
    md_bg_color: 1, 1, 1, 1

    FloatLayout:

        # --- HEADER FIJO ---
        MDLabel:
            text: "Crear cuenta"
            halign: "center"
            font_style: "H5"
            bold: True
            theme_text_color: "Custom"
            text_color: 0.9686, 0.5765, 0.1176, 1
            size_hint_y: None
            height: dp(48)
            pos_hint: {"top": 1}

        # --- SCROLL DEL FORMULARIO ---
        ScrollView:
            size_hint: 1, None
            height: root.height - dp(30)
            pos_hint: {"x": 0, "y": 0}

            MDBoxLayout:
                orientation: "vertical"
                padding: dp(20), dp(15)
                spacing: dp(3)
                size_hint_y: None
                height: self.minimum_height

                MDTextField:
                    hint_text: "Username"
                    on_text: root.username = self.text

                MDTextField:
                    id: rol_input
                    hint_text: "Tipo de usuario"
                    text: root.rol
                    readonly: True
                    on_focus: if self.focus: root.abrir_menu_roles()

                MDTextField:
                    hint_text: "Nombre(s)"
                    on_text: root.nombre = self.text

                MDTextField:
                    hint_text: "Apellido(s)"
                    on_text: root.apellido = self.text

                MDTextField:
                    hint_text: "Correo Electrónico"
                    on_text: root.correo = self.text

                MDTextField:
                    hint_text: "Teléfono"
                    on_text: root.telefono = self.text

                MDTextField:
                    hint_text: "Contraseña"
                    password: True
                    on_text: root.password = self.text

                MDRaisedButton:
                    text: "Foto cargada" if root.foto_cargada else "Tomar Foto"
                    size_hint_x: 1
                    size_hint_y: None
                    height: dp(40)
                    on_release: root.seleccionar_foto()

                    md_bg_color:
                        (0, 0.7, 0, 1) if root.foto_cargada else (0.3, 0.3, 0.3, 1)

                # --- BOTONES (YA NO SE PIERDEN) ---

        MDFloatingActionButton:
            icon: "check"
            md_bg_color: 0, 0.7, 0, 1
            pos_hint: {"right": 0.95, "y": 0.03}
            on_release: root.registrar()

        MDFloatingActionButton:
            icon: "close"
            md_bg_color: 0.9 , 0.0, 0.0 , 1
            pos_hint: {"right": 0.75, "y": 0.03}
            on_release: root.manager.current = "login"

        MDLabel:
            text: root.mensaje
            halign: "center"
            size_hint_y: None
            height: dp(30)

