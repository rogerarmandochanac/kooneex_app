<TarifaItem@MDCard>:
    orientation: "vertical"
    padding: dp(12)
    spacing: dp(8)
    size_hint_y: None
    height: dp(190)
    radius: [14]
    elevation: 0
    md_bg_color: 0.98, 0.97, 0.95, 1
    oferta_id: 0
    mototaxista_nombre: ""
    monto: ""
    mototaxista_foto: ""
    
    canvas.after:
        Color:
            rgba: 0, 0, 0, 0.08   # gris muy sutil estilo material
        Rectangle:
            pos: self.x + dp(16), self.y
            size: self.width - dp(32), dp(1)

    MDBoxLayout:
        spacing: dp(8)

        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'

            AnchorLayout:
                anchor_x:'left'
                anchor_y:'center'

                BoxLayout:
                    orientation:'vertical'
                    size_hint_y: None
                    height: self.minimum_height
                    spacing: dp(4)
                    MDLabel:
                        text: "[b]Mototaxista:[/b] {}".format(root.mototaxista_nombre)
                        markup: True
                        size_hint_y: None
                        height: self.texture_size[1]

                    MDLabel:
                        text: "[b]Tarifa sugerida:[/b] ${} MXN".format(root.monto)
                        markup: True
                        size_hint_y: None
                        height: self.texture_size[1]

            AnchorLayout:
                anchor_x:'right'
                anchor_y:'center'

                FitImage:
                    source: root.mototaxista_foto or "assets/user_placeholder.png"
                    size_hint: None, None
                    size: dp(80), dp(80)
                    radius: [40]
                    canvas.after:
                        Color:
                            rgba: 0.9686, 0.5765, 0.1176, 1
                        Line:
                            width: 1.5
                            rounded_rectangle: (self.x, self.y, self.width, self.height, 40)

    Button:
        text: "Aceptar"
        size_hint_x: .5
        pos_hint: {"center_x": .5}
        size_hint_y: None
        height: dp(40)

        background_normal: ""
        background_down: ""
        background_color: 0, 0, 0, 0  # ðŸ”¥ MUY IMPORTANTE

        color: 1, 1, 1, 1  # texto blanco

        canvas.before:
            Color:
                rgba: (0.85, 0.45, 0.05, 1) if self.state == "down" else (0.9686, 0.5765, 0.1176, 1)
            RoundedRectangle:
                pos: self.pos
                size: self.size
                radius: [15, 15, 15, 15]

        on_release: app.root.get_screen("tarifas").aceptar_oferta(root.oferta_id)
